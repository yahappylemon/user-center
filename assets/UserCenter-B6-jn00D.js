import{av as T,ak as k,aw as f,r as x,j as a,W as F,h as W,T as B,a6 as z,B as j,aj as g,ad as h,aa as D,ax as y,ay as U,D as v,az as l,aA as A,aB as L,aC as R}from"./index-COmD0C1s.js";import{G as u}from"./Grid2-BVKn_g2Z.js";function P(){const C=T(),E=k(),c=f(e=>e.auth.username),b=f(e=>e.theme.theme),[s,o]=x.useState({username:!1,usernameExist:!1,sameUsername:!1}),[n,p]=x.useState({id:"",email:"",username:""});x.useEffect(()=>{async function e(){const r=await L();p(r.data.data)}e()},[]);function I(e,r,i){const{name:m,value:t}=e.target;p(d=>({...d,[m]:t})),o(()=>({...s,[m]:!1,[r]:!1,[i]:!1}))}function S(e){const r=y(e.username,3,20),i=U(e.username,c);return{username:r,sameUsername:i}}async function w(e){var i,m;e.preventDefault();const r=S(n);if(o(t=>({...t,...r})),!(r.username||r.sameUsername))try{await R(n),E("/auth?mode=login")}catch(t){((m=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:m.message)==="用戶名已被使用"&&o(d=>({...d,usernameExist:`${n.username} is already taken`}))}}return a.jsx(F,{children:a.jsxs(W,{sx:{width:"100%"},children:[a.jsx(B,{variant:"h5",component:"h1",children:"User Center"}),a.jsxs(u,{component:"form",onSubmit:w,noValidate:!0,container:!0,rowSpacing:1,columnSpacing:1,sx:{alignItems:"flex-end"},children:[a.jsx(u,{size:{xs:12,sm:8},children:a.jsxs(z,{fullWidth:!0,children:[a.jsxs(j,{sx:{display:"flex",justifyContent:"space-between"},children:[a.jsx(g,{htmlFor:"username",children:"Username"}),a.jsxs(j,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[s.username&&a.jsx(h,{error:!0,sx:{m:0},children:s.username}),s.usernameExist&&a.jsx(h,{error:!0,sx:{m:0},children:s.usernameExist}),s.sameUsername&&a.jsx(h,{error:!0,sx:{m:0},children:s.sameUsername})]})]}),a.jsx(D,{id:"username",label:"",type:"text",placeholder:"name",fullWidth:!0,required:!0,value:n,variant:"outlined",onChange:e=>I(e,"sameUsername","usernameExist"),error:s.username&&!0||s.sameUsername&&!0||s.usernameExist&&!0,onBlur:()=>o(e=>({...e,username:y(n.username,3,20),sameUsername:U(n.username,c)}))})]})}),a.jsx(u,{size:{xs:12,sm:4},children:a.jsx(v,{type:"submit",fullWidth:!0,disabled:n.username===c||n.username==="",variant:"contained",sx:{py:2},children:"Change Username"})})]}),a.jsx(g,{children:"Change Theme"}),a.jsx(u,{container:!0,rowSpacing:1,columnSpacing:1,children:Object.keys(l).map(e=>a.jsx(u,{size:{xs:12,sm:4},children:a.jsx(v,{fullWidth:!0,variant:"contained",onClick:()=>{C(A({key:"theme",theme:`${e}`}))},sx:{py:2,bgcolor:l[e].primary.main,color:l[e].primary.contrastText,"&:hover":{bgcolor:l[e].primary.dark}},disabled:e===b,children:e})},e))})]})})}export{P as default};
